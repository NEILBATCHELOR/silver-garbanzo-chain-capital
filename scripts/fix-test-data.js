#!/usr/bin/env node

import { randomUUID } from 'crypto';
import fs from 'fs';
import path from 'path';

// Function to convert ISO date to YYYY-MM-DD format
function convertDate(isoDate) {
  if (!isoDate || isoDate === '') return '';
  return isoDate.split('T')[0];
}

// Function to fix JSON strings (remove extra escaping)
function fixJsonString(jsonStr) {
  if (!jsonStr) return '';
  
  // Replace escaped quotes with regular quotes
  let fixed = jsonStr.replace(/\\"/g, '"');
  
  // Ensure it's properly formatted JSON
  try {
    JSON.parse(fixed);
    return fixed;
  } catch (e) {
    console.warn('Could not parse JSON:', jsonStr);
    return jsonStr;
  }
}

// Generate corrected investor data
const correctedInvestorData = [
  // Header row
  'name,email,company,type,notes,investor_type,investor_status,onboarding_completed,wallet_address,kyc_status,kyc_verified_at,kyc_expiry_date,verification_details,accreditation_status,accreditation_type,accreditation_verified_at,accreditation_expires_at,risk_score,risk_factors,risk_assessment,tax_residency,tax_id_number,last_compliance_check,investment_preferences,profile_data,user_id,lastUpdated',
  
  // Row 1
  `"John Richardson Smith","john.smith@wealthfund.com","Smith Investment Holdings","individual","High net worth individual, technology executive","high_net_worth","active","true","0x1234567890123456789012345678901234567890","approved","2024-12-01","2025-12-01","{\\"provider\\": \\"Jumio\\", \\"documentType\\": \\"passport\\", \\"verificationLevel\\": \\"enhanced\\", \\"biometricMatch\\": true}","approved","income","2024-12-01","2025-10-15","25","[\\"high_income\\", \\"stable_employment\\", \\"us_person\\"]","{\\"score\\": 25, \\"level\\": \\"low\\", \\"factors\\": [{\\"type\\": \\"income\\", \\"weight\\": 0.3, \\"value\\": \\"high\\"}, {\\"type\\": \\"geography\\", \\"weight\\": 0.2, \\"value\\": \\"low_risk\\"}], \\"lastUpdated\\": \\"2024-12-01\\", \\"methodology\\": \\"standard_v2\\"}","United States","123-45-6789","2024-12-01","{\\"preferredAssetClasses\\": [\\"technology\\", \\"healthcare\\"], \\"riskTolerance\\": \\"moderate\\", \\"investmentHorizon\\": \\"long_term\\", \\"minimumInvestment\\": 100000, \\"maximumInvestment\\": 2000000}","{\\"investorSince\\": \\"2020-01-15\\", \\"totalInvestments\\": 25, \\"averageInvestmentSize\\": 450000, \\"preferredCommunication\\": \\"email\\", \\"languages\\": [\\"en\\"], \\"timezone\\": \\"EST\\"}","${randomUUID()}","2024-12-01"`,
  
  // Row 2
  `"Sarah Elizabeth Chen","sarah.chen@chenventures.com","Chen Ventures LLC","individual","Angel investor and serial entrepreneur","qualified_purchaser","active","true","0x2345678901234567890123456789012345678901","approved","2024-11-15","2025-11-15","{\\"provider\\": \\"Onfido\\", \\"documentType\\": \\"drivers_license\\", \\"verificationLevel\\": \\"enhanced\\", \\"biometricMatch\\": true}","approved","net_worth","2024-11-15","2025-09-01","35","[\\"entrepreneur\\", \\"diversified_portfolio\\", \\"venture_capital\\"]","{\\"score\\": 35, \\"level\\": \\"moderate\\", \\"factors\\": [{\\"type\\": \\"income\\", \\"weight\\": 0.3, \\"value\\": \\"very_high\\"}, {\\"type\\": \\"experience\\", \\"weight\\": 0.2, \\"value\\": \\"expert\\"}], \\"lastUpdated\\": \\"2024-11-15\\", \\"methodology\\": \\"standard_v2\\"}","United States","234-56-7890","2024-11-15","{\\"preferredAssetClasses\\": [\\"fintech\\", \\"ai\\", \\"biotech\\"], \\"riskTolerance\\": \\"high\\", \\"investmentHorizon\\": \\"medium_term\\", \\"minimumInvestment\\": 250000, \\"maximumInvestment\\": 5000000}","{\\"investorSince\\": \\"2018-03-10\\", \\"totalInvestments\\": 87, \\"averageInvestmentSize\\": 850000, \\"preferredCommunication\\": \\"email\\", \\"languages\\": [\\"en\\"], \\"timezone\\": \\"PST\\"}","${randomUUID()}","2024-11-15"`,
  
  // Row 3
  `"Hans Mueller","hans.mueller@deutsche-invest.de","","individual","German institutional investor representative","institutional","active","true","0x3456789012345678901234567890123456789012","approved","2024-10-20","2025-10-20","{\\"provider\\": \\"IDnow\\", \\"documentType\\": \\"national_id\\", \\"verificationLevel\\": \\"enhanced\\", \\"biometricMatch\\": true}","approved","institutional","2024-10-20","2025-08-10","20","[\\"institutional_backing\\", \\"regulated_entity\\", \\"eu_person\\"]","{\\"score\\": 20, \\"level\\": \\"low\\", \\"factors\\": [{\\"type\\": \\"institution\\", \\"weight\\": 0.4, \\"value\\": \\"regulated\\"}, {\\"type\\": \\"geography\\", \\"weight\\": 0.2, \\"value\\": \\"eu\\"}], \\"lastUpdated\\": \\"2024-10-20\\", \\"methodology\\": \\"institutional_v1\\"}","Germany","DE123456789","2024-10-20","{\\"preferredAssetClasses\\": [\\"real_estate\\", \\"infrastructure\\", \\"private_debt\\"], \\"riskTolerance\\": \\"conservative\\", \\"investmentHorizon\\": \\"long_term\\", \\"minimumInvestment\\": 500000}","{\\"investorSince\\": \\"2015-06-01\\", \\"totalInvestments\\": 45, \\"averageInvestmentSize\\": 1200000, \\"preferredCommunication\\": \\"email\\", \\"languages\\": [\\"de\\", \\"en\\"], \\"timezone\\": \\"CET\\"}","${randomUUID()}","2024-10-20"`,
  
  // Row 4
  `"Margaret Foster-Williams","margaret.foster@pension-trustees.co.uk","UK Teachers Pension Scheme","institutional","Trustee representing Â£50B pension fund","pension_fund","active","true","0x5678901234567890123456789012345678901234","approved","2024-09-10","2025-09-10","{\\"provider\\": \\"GBG\\", \\"documentType\\": \\"passport\\", \\"verificationLevel\\": \\"enhanced\\", \\"institutionVerified\\": true}","approved","qualified_institutional_buyer","2024-09-10","2025-07-01","10","[\\"pension_fund\\", \\"fiduciary_duty\\", \\"long_term_mandate\\"]","{\\"score\\": 10, \\"level\\": \\"very_low\\", \\"factors\\": [{\\"type\\": \\"institution\\", \\"weight\\": 0.5, \\"value\\": \\"pension_fund\\"}, {\\"type\\": \\"mandate\\", \\"weight\\": 0.3, \\"value\\": \\"fiduciary\\"}], \\"lastUpdated\\": \\"2024-09-10\\", \\"methodology\\": \\"institutional_v1\\"}","United Kingdom","GB123456789","2024-09-10","{\\"preferredAssetClasses\\": [\\"infrastructure\\", \\"real_estate\\", \\"private_debt\\", \\"renewable_energy\\"], \\"riskTolerance\\": \\"conservative\\", \\"investmentHorizon\\": \\"very_long_term\\", \\"esgRequirements\\": true, \\"minimumInvestment\\": 10000000}","{\\"investorSince\\": \\"2010-01-15\\", \\"institutionAUM\\": 50000000000, \\"investmentAuthority\\": 500000000, \\"fiduciaryDuty\\": true, \\"regulatoryStatus\\": \\"fca_regulated\\"}","${randomUUID()}","2024-09-10"`,
  
  // Row 5
  `"Charles Worthington III","charles@worthington-office.com","Worthington Family Office","institutional","Multi-generational family office $2B AUM","family_office","active","true","0x6789012345678901234567890123456789012345","approved","2024-08-25","2025-08-25","{\\"provider\\": \\"Jumio\\", \\"documentType\\": \\"passport\\", \\"verificationLevel\\": \\"enhanced\\", \\"familyOfficeVerified\\": true}","approved","qualified_purchaser","2024-08-25","2025-06-15","30","[\\"family_office\\", \\"diversified_strategies\\", \\"long_term_horizon\\"]","{\\"score\\": 30, \\"level\\": \\"moderate\\", \\"factors\\": [{\\"type\\": \\"family_office\\", \\"weight\\": 0.4, \\"value\\": \\"multi_generation\\"}, {\\"type\\": \\"diversification\\", \\"weight\\": 0.3, \\"value\\": \\"high\\"}], \\"lastUpdated\\": \\"2024-08-25\\", \\"methodology\\": \\"family_office_v1\\"}","United States","345-67-8901","2024-08-25","{\\"preferredAssetClasses\\": [\\"private_equity\\", \\"hedge_funds\\", \\"real_estate\\", \\"venture_capital\\", \\"art\\"], \\"riskTolerance\\": \\"moderate_aggressive\\", \\"investmentHorizon\\": \\"long_term\\", \\"minimumInvestment\\": 1000000}","{\\"investorSince\\": \\"1995-01-01\\", \\"familyAUM\\": 2000000000, \\"investmentAuthority\\": 100000000, \\"generationsRepresented\\": 3, \\"familyOfficeType\\": \\"single_family\\"}","${randomUUID()}","2024-08-25"`,
  
  // Row 6
  `"Abdullah Al-Rashid","abdullah.rashid@swf-emirates.ae","Emirates Strategic Investment Fund","institutional","Sovereign wealth fund representative","sovereign","active","true","0x7890123456789012345678901234567890123456","approved","2024-07-10","2025-07-10","{\\"provider\\": \\"Veriff\\", \\"documentType\\": \\"passport\\", \\"verificationLevel\\": \\"enhanced\\", \\"sovereignEntityVerified\\": true}","approved","qualified_institutional_buyer","2024-07-10","2025-05-01","15","[\\"sovereign_fund\\", \\"strategic_mandate\\", \\"government_backing\\"]","{\\"score\\": 15, \\"level\\": \\"low\\", \\"factors\\": [{\\"type\\": \\"sovereign\\", \\"weight\\": 0.5, \\"value\\": \\"government_backed\\"}, {\\"type\\": \\"mandate\\", \\"weight\\": 0.3, \\"value\\": \\"strategic\\"}], \\"lastUpdated\\": \\"2024-07-10\\", \\"methodology\\": \\"sovereign_v1\\"}","United Arab Emirates","AE789123456","2024-07-10","{\\"preferredAssetClasses\\": [\\"infrastructure\\", \\"technology\\", \\"healthcare\\", \\"renewable_energy\\"], \\"riskTolerance\\": \\"moderate\\", \\"investmentHorizon\\": \\"very_long_term\\", \\"strategicInvestments\\": true, \\"minimumInvestment\\": 50000000}","{\\"investorSince\\": \\"2005-01-01\\", \\"fundAUM\\": 75000000000, \\"investmentAuthority\\": 1000000000, \\"sovereignMandate\\": true, \\"strategicFocus\\": [\\"technology\\", \\"healthcare\\"]}","${randomUUID()}","2024-07-10"`,
  
  // Row 7
  `"Jennifer Morrison","jennifer.morrison@email.com","","individual","Retail investor first-time participant","retail_accredited","pending","false","0x8901234567890123456789012345678901234567","pending","2025-02-01","2026-02-01","{\\"provider\\": \\"Jumio\\", \\"documentType\\": \\"drivers_license\\", \\"verificationLevel\\": \\"basic\\", \\"biometricMatch\\": false}","pending","accredited_investor","2025-02-01","2025-11-15","40","[\\"first_time_investor\\", \\"limited_experience\\", \\"moderate_income\\"]","{\\"score\\": 40, \\"level\\": \\"moderate_high\\", \\"factors\\": [{\\"type\\": \\"experience\\", \\"weight\\": 0.4, \\"value\\": \\"limited\\"}, {\\"type\\": \\"income\\", \\"weight\\": 0.3, \\"value\\": \\"moderate\\"}], \\"lastUpdated\\": \\"2025-02-01\\", \\"methodology\\": \\"standard_v2\\"}","Canada","CA123456789","2025-02-01","{\\"preferredAssetClasses\\": [\\"technology\\", \\"etfs\\"], \\"riskTolerance\\": \\"moderate\\", \\"investmentHorizon\\": \\"medium_term\\", \\"minimumInvestment\\": 25000, \\"maximumInvestment\\": 100000}","{\\"investorSince\\": \\"2025-01-15\\", \\"totalInvestments\\": 1, \\"averageInvestmentSize\\": 35000, \\"preferredCommunication\\": \\"email\\", \\"languages\\": [\\"en\\"], \\"timezone\\": \\"EST\\"}","${randomUUID()}","2025-02-01"`,
  
  // Row 8
  `"David Kim","david.kim@techcorp-treasury.com","TechCorp International Ltd","institutional","Corporate treasury managing surplus cash","corporate","active","true","0x9012345678901234567890123456789012345678","approved","2024-06-15","2025-06-15","{\\"provider\\": \\"Onfido\\", \\"documentType\\": \\"passport\\", \\"verificationLevel\\": \\"enhanced\\", \\"corporateVerified\\": true}","approved","qualified_institutional_buyer","2024-06-15","2025-04-01","20","[\\"corporate_treasury\\", \\"conservative_mandate\\", \\"regulated_entity\\"]","{\\"score\\": 20, \\"level\\": \\"low\\", \\"factors\\": [{\\"type\\": \\"corporate\\", \\"weight\\": 0.4, \\"value\\": \\"treasury\\"}, {\\"type\\": \\"mandate\\", \\"weight\\": 0.3, \\"value\\": \\"conservative\\"}], \\"lastUpdated\\": \\"2024-06-15\\", \\"methodology\\": \\"corporate_v1\\"}","Singapore","SG456789123","2024-06-15","{\\"preferredAssetClasses\\": [\\"money_market\\", \\"short_term_bonds\\", \\"stable_value\\"], \\"riskTolerance\\": \\"conservative\\", \\"investmentHorizon\\": \\"short_term\\", \\"liquidityNeeds\\": \\"high\\", \\"minimumInvestment\\": 1000000}","{\\"investorSince\\": \\"2020-06-01\\", \\"corporateAUM\\": 500000000, \\"investmentAuthority\\": 50000000, \\"fiduciaryDuty\\": true, \\"treasuryMandate\\": true}","${randomUUID()}","2024-06-15"`,
  
  // Row 9
  `"Rebecca Thompson","rebecca.thompson@endowment-fund.org","University Endowment","institutional","Educational institution endowment manager","endowment","active","true","0x0123456789012345678901234567890123456789","approved","2024-05-20","2025-05-20","{\\"provider\\": \\"Jumio\\", \\"documentType\\": \\"passport\\", \\"verificationLevel\\": \\"enhanced\\", \\"institutionVerified\\": true}","approved","qualified_institutional_buyer","2024-05-20","2025-03-15","18","[\\"endowment_fund\\", \\"long_term_mandate\\", \\"diversified_portfolio\\"]","{\\"score\\": 18, \\"level\\": \\"low\\", \\"factors\\": [{\\"type\\": \\"institution\\", \\"weight\\": 0.4, \\"value\\": \\"endowment\\"}, {\\"type\\": \\"mandate\\", \\"weight\\": 0.3, \\"value\\": \\"perpetual\\"}], \\"lastUpdated\\": \\"2024-05-20\\", \\"methodology\\": \\"institutional_v1\\"}","United States","456-78-9012","2024-05-20","{\\"preferredAssetClasses\\": [\\"alternatives\\", \\"real_estate\\", \\"private_equity\\", \\"hedge_funds\\"], \\"riskTolerance\\": \\"moderate_aggressive\\", \\"investmentHorizon\\": \\"very_long_term\\", \\"minimumInvestment\\": 5000000}","{\\"investorSince\\": \\"2012-09-01\\", \\"endowmentAUM\\": 8500000000, \\"investmentAuthority\\": 200000000, \\"fiduciaryDuty\\": true, \\"spendingPolicy\\": 4.5}","${randomUUID()}","2024-05-20"`,
  
  // Row 10
  `"Michael O'Connor","michael.oconnor@hedge-alpha.com","Alpha Hedge Strategies","institutional","Hedge fund manager and institutional trader","hedge_fund","active","true","0x1122334455667788990011223344556677889900","approved","2024-04-12","2025-04-12","{\\"provider\\": \\"Onfido\\", \\"documentType\\": \\"passport\\", \\"verificationLevel\\": \\"enhanced\\", \\"institutionVerified\\": true}","approved","qualified_institutional_buyer","2024-04-12","2025-02-28","28","[\\"hedge_fund\\", \\"sophisticated_strategies\\", \\"high_frequency_trading\\"]","{\\"score\\": 28, \\"level\\": \\"moderate\\", \\"factors\\": [{\\"type\\": \\"strategy\\", \\"weight\\": 0.4, \\"value\\": \\"sophisticated\\"}, {\\"type\\": \\"experience\\", \\"weight\\": 0.3, \\"value\\": \\"expert\\"}], \\"lastUpdated\\": \\"2024-04-12\\", \\"methodology\\": \\"hedge_fund_v1\\"}","United States","567-89-0123","2024-04-12","{\\"preferredAssetClasses\\": [\\"derivatives\\", \\"currencies\\", \\"commodities\\", \\"structured_products\\"], \\"riskTolerance\\": \\"aggressive\\", \\"investmentHorizon\\": \\"short_term\\", \\"leverageCapacity\\": true, \\"minimumInvestment\\": 2000000}","{\\"investorSince\\": \\"2008-01-01\\", \\"fundAUM\\": 1500000000, \\"investmentAuthority\\": 100000000, \\"tradingStrategies\\": [\\"long_short_equity\\", \\"global_macro\\"], \\"primebrokers\\": 5}","${randomUUID()}","2024-04-12"`
];

// Generate corrected issuer data
const correctedIssuerData = [
  // Header row
  'name,legal_name,registration_number,registration_date,tax_id,jurisdiction,business_type,status,compliance_status,onboarding_completed,contact_email,contact_phone,website,address,legal_representatives',
  
  // Row 1
  `"TechnoFin Solutions Inc","TechnoFin Solutions Incorporated","DE-2024-8765432","2019-03-15","83-1234567","Delaware","technology","active","compliant","true","legal@technofin.com","+1-555-0123","https://www.technofin.com","{\\"street\\": \\"1200 Innovation Drive\\", \\"city\\": \\"San Francisco\\", \\"state\\": \\"California\\", \\"zip\\": \\"94105\\", \\"country\\": \\"United States\\"}","{\\"ceo\\": {\\"name\\": \\"Sarah Chen\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"sarah.chen@technofin.com\\"}, \\"cfo\\": {\\"name\\": \\"Michael Rodriguez\\", \\"title\\": \\"Chief Financial Officer\\", \\"email\\": \\"michael.rodriguez@technofin.com\\"}, \\"legal_counsel\\": {\\"name\\": \\"Jennifer Park\\", \\"title\\": \\"General Counsel\\", \\"email\\": \\"jennifer.park@technofin.com\\"}}"`,
  
  // Row 2
  `"BioMedical Innovations Corp","BioMedical Innovations Corporation","DE-2021-5432109","2021-07-22","84-2345678","Delaware","biotechnology","pending","pending_review","false","compliance@biomed-innovations.com","+1-555-0234","https://www.biomed-innovations.com","{\\"street\\": \\"450 Research Parkway\\", \\"city\\": \\"Boston\\", \\"state\\": \\"Massachusetts\\", \\"zip\\": \\"02215\\", \\"country\\": \\"United States\\"}","{\\"ceo\\": {\\"name\\": \\"Dr. Robert Williams\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"robert.williams@biomed-innovations.com\\"}, \\"cso\\": {\\"name\\": \\"Dr. Lisa Thompson\\", \\"title\\": \\"Chief Scientific Officer\\", \\"email\\": \\"lisa.thompson@biomed-innovations.com\\"}, \\"regulatory\\": {\\"name\\": \\"Amanda Foster\\", \\"title\\": \\"VP Regulatory Affairs\\", \\"email\\": \\"amanda.foster@biomed-innovations.com\\"}}"`,
  
  // Row 3
  `"Metropolitan Property REIT","Metropolitan Property Real Estate Investment Trust","MD-2018-9876543","2018-11-08","85-3456789","Maryland","real_estate_investment_trust","active","compliant","true","investors@metro-reit.com","+1-555-0345","https://www.metro-reit.com","{\\"street\\": \\"800 Commerce Street\\", \\"city\\": \\"Baltimore\\", \\"state\\": \\"Maryland\\", \\"zip\\": \\"21202\\", \\"country\\": \\"United States\\"}","{\\"ceo\\": {\\"name\\": \\"James Morrison\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"james.morrison@metro-reit.com\\"}, \\"president\\": {\\"name\\": \\"Patricia Davis\\", \\"title\\": \\"President\\", \\"email\\": \\"patricia.davis@metro-reit.com\\"}, \\"trustees\\": [{\\"name\\": \\"Charles Baker\\", \\"title\\": \\"Chairman of Trustees\\", \\"email\\": \\"charles.baker@metro-reit.com\\"}]}"`,
  
  // Row 4
  `"GreenEnergy Infrastructure Ltd","GreenEnergy Infrastructure Limited","UK-12345678","2020-04-12","GB123456789","United Kingdom","renewable_energy","active","compliant","true","corporate@greenenergy-infra.co.uk","+44-20-7123-4567","https://www.greenenergy-infra.co.uk","{\\"street\\": \\"25 Canary Wharf\\", \\"city\\": \\"London\\", \\"zip\\": \\"E14 5AB\\", \\"country\\": \\"United Kingdom\\"}","{\\"ceo\\": {\\"name\\": \\"Oliver Henderson\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"oliver.henderson@greenenergy-infra.co.uk\\"}, \\"cfo\\": {\\"name\\": \\"Emma Richardson\\", \\"title\\": \\"Chief Financial Officer\\", \\"email\\": \\"emma.richardson@greenenergy-infra.co.uk\\"}, \\"technical\\": {\\"name\\": \\"Dr. Ian Stewart\\", \\"title\\": \\"Chief Technology Officer\\", \\"email\\": \\"ian.stewart@greenenergy-infra.co.uk\\"}}"`,
  
  // Row 5
  `"Quantum Asset Management LLP","Quantum Asset Management Limited Liability Partnership","NY-2017-4567890","2017-09-30","86-4567890","New York","investment_management","active","compliant","true","compliance@quantum-assets.com","+1-555-0456","https://www.quantum-assets.com","{\\"street\\": \\"200 West Street\\", \\"city\\": \\"New York\\", \\"state\\": \\"New York\\", \\"zip\\": \\"10282\\", \\"country\\": \\"United States\\"}","{\\"managing_partner\\": {\\"name\\": \\"David Kim\\", \\"title\\": \\"Managing Partner\\", \\"email\\": \\"david.kim@quantum-assets.com\\"}, \\"cio\\": {\\"name\\": \\"Dr. Elena Rodriguez\\", \\"title\\": \\"Chief Investment Officer\\", \\"email\\": \\"elena.rodriguez@quantum-assets.com\\"}, \\"compliance\\": {\\"name\\": \\"Michael Johnson\\", \\"title\\": \\"Chief Compliance Officer\\", \\"email\\": \\"michael.johnson@quantum-assets.com\\"}}"`,
  
  // Row 6
  `"Capital Credit Partners Fund I","Capital Credit Partners Fund I L.P.","DE-2022-1357924","2022-02-14","87-5678901","Delaware","private_fund","active","compliant","true","operations@capital-credit.com","+1-555-0567","https://www.capital-credit.com","{\\"street\\": \\"600 Fifth Avenue\\", \\"city\\": \\"New York\\", \\"state\\": \\"New York\\", \\"zip\\": \\"10020\\", \\"country\\": \\"United States\\"}","{\\"general_partner\\": {\\"name\\": \\"Thomas Anderson\\", \\"title\\": \\"General Partner\\", \\"email\\": \\"thomas.anderson@capital-credit.com\\"}, \\"investment_committee\\": [{\\"name\\": \\"Rachel Green\\", \\"title\\": \\"Managing Director\\", \\"email\\": \\"rachel.green@capital-credit.com\\"}, {\\"name\\": \\"Mark Stevens\\", \\"title\\": \\"Senior Partner\\", \\"email\\": \\"mark.stevens@capital-credit.com\\"}]}"`,
  
  // Row 7
  `"Alpine Investment Management AG","Alpine Investment Management Aktiengesellschaft","CH-2019-2468135","2019-06-18","CHE-123456789","Switzerland","asset_management","active","compliant","true","legal@alpine-im.ch","+41-44-123-4567","https://www.alpine-im.ch","{\\"street\\": \\"Bahnhofstrasse 45\\", \\"city\\": \\"Zurich\\", \\"zip\\": \\"8001\\", \\"country\\": \\"Switzerland\\"}","{\\"ceo\\": {\\"name\\": \\"Hans Weber\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"hans.weber@alpine-im.ch\\"}, \\"cro\\": {\\"name\\": \\"Claudia Mueller\\", \\"title\\": \\"Chief Risk Officer\\", \\"email\\": \\"claudia.mueller@alpine-im.ch\\"}, \\"compliance\\": {\\"name\\": \\"Andreas Zimmermann\\", \\"title\\": \\"Head of Compliance\\", \\"email\\": \\"andreas.zimmermann@alpine-im.ch\\"}}"`,
  
  // Row 8
  `"Pacific Rim Investments Pte Ltd","Pacific Rim Investments Private Limited","SG-2020-9876543","2020-10-25","SG123456789C","Singapore","investment_company","pending","pending_review","false","regulatory@pacific-rim.com.sg","+65-6123-4567","https://www.pacific-rim.com.sg","{\\"street\\": \\"1 Raffles Place\\", \\"city\\": \\"Singapore\\", \\"zip\\": \\"048616\\", \\"country\\": \\"Singapore\\"}","{\\"ceo\\": {\\"name\\": \\"Li Wei Chen\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"li.chen@pacific-rim.com.sg\\"}, \\"cio\\": {\\"name\\": \\"Priya Sharma\\", \\"title\\": \\"Chief Investment Officer\\", \\"email\\": \\"priya.sharma@pacific-rim.com.sg\\"}, \\"compliance\\": {\\"name\\": \\"Tan Wei Ming\\", \\"title\\": \\"Compliance Director\\", \\"email\\": \\"wei.tan@pacific-rim.com.sg\\"}}"`,
  
  // Row 9
  `"Global Infrastructure Partners II","Global Infrastructure Partners II L.P.","DE-2023-1122334","2023-01-12","88-6789012","Delaware","infrastructure_fund","active","compliant","true","investor.relations@global-infra.com","+1-555-0678","https://www.global-infra.com","{\\"street\\": \\"345 Park Avenue\\", \\"city\\": \\"New York\\", \\"state\\": \\"New York\\", \\"zip\\": \\"10154\\", \\"country\\": \\"United States\\"}","{\\"managing_partner\\": {\\"name\\": \\"Catherine Williams\\", \\"title\\": \\"Managing Partner\\", \\"email\\": \\"catherine.williams@global-infra.com\\"}, \\"investment_team\\": [{\\"name\\": \\"Roberto Silva\\", \\"title\\": \\"Principal\\", \\"email\\": \\"roberto.silva@global-infra.com\\"}, {\\"name\\": \\"Jennifer Chang\\", \\"title\\": \\"Vice President\\", \\"email\\": \\"jennifer.chang@global-infra.com\\"}]}"`,
  
  // Row 10
  `"Atlantic Commodities Trading Ltd","Atlantic Commodities Trading Limited","UK-87654321","2016-12-03","GB987654321","United Kingdom","commodities_trading","active","compliant","true","compliance@atlantic-commodities.com","+44-20-8765-4321","https://www.atlantic-commodities.com","{\\"street\\": \\"100 Bishopsgate\\", \\"city\\": \\"London\\", \\"zip\\": \\"EC2N 4EX\\", \\"country\\": \\"United Kingdom\\"}","{\\"ceo\\": {\\"name\\": \\"Alexander Thomson\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"alexander.thomson@atlantic-commodities.com\\"}, \\"head_trading\\": {\\"name\\": \\"Sophie Davis\\", \\"title\\": \\"Head of Trading\\", \\"email\\": \\"sophie.davis@atlantic-commodities.com\\"}, \\"risk\\": {\\"name\\": \\"James Wright\\", \\"title\\": \\"Chief Risk Officer\\", \\"email\\": \\"james.wright@atlantic-commodities.com\\"}}"`,
  
  // Row 11
  `"Healthcare Real Estate SPV I","Healthcare Real Estate Special Purpose Vehicle I LLC","DE-2024-5555555","2024-03-20","89-7890123","Delaware","special_purpose_vehicle","pending","pending_review","false","legal@healthcare-re-spv.com","+1-555-0789","","{\\"street\\": \\"c/o Corporation Service Company\\", \\"city\\": \\"Wilmington\\", \\"state\\": \\"Delaware\\", \\"zip\\": \\"19801\\", \\"country\\": \\"United States\\"}","{\\"manager\\": {\\"name\\": \\"Healthcare REIT Management LLC\\", \\"title\\": \\"Managing Member\\", \\"email\\": \\"manager@healthcare-re-spv.com\\"}, \\"sponsor\\": {\\"name\\": \\"National Healthcare Properties\\", \\"title\\": \\"Sponsor\\", \\"email\\": \\"sponsor@healthcare-re-spv.com\\"}}"`,
  
  // Row 12
  `"Structured Finance Solutions SA","Structured Finance Solutions SociÃ©tÃ© Anonyme","LU-2021-7777777","2021-08-14","LU12345678","Luxembourg","structured_products","active","compliant","true","operations@structured-finance.lu","+352-26-12-34-56","https://www.structured-finance.lu","{\\"street\\": \\"12 Rue EugÃ¨ne Ruppert\\", \\"city\\": \\"Luxembourg\\", \\"zip\\": \\"L-2453\\", \\"country\\": \\"Luxembourg\\"}","{\\"ceo\\": {\\"name\\": \\"Marie Dubois\\", \\"title\\": \\"Chief Executive Officer\\", \\"email\\": \\"marie.dubois@structured-finance.lu\\"}, \\"structuring\\": {\\"name\\": \\"Klaus Weber\\", \\"title\\": \\"Head of Structuring\\", \\"email\\": \\"klaus.weber@structured-finance.lu\\"}, \\"operations\\": {\\"name\\": \\"Laura Rossi\\", \\"title\\": \\"Chief Operating Officer\\", \\"email\\": \\"laura.rossi@structured-finance.lu\\"}}"`,
];

// Write the corrected files
const testDataDir = '/Users/neilbatchelor/Cursor/Chain Capital Production-build-progress/test-data';

// Create investor test data file
fs.writeFileSync(path.join(testDataDir, 'investortestdata.csv'), correctedInvestorData.join('\n'), 'utf8');

// Create issuer test data file  
fs.writeFileSync(path.join(testDataDir, 'issuertestdata.csv'), correctedIssuerData.join('\n'), 'utf8');

console.log('â Fixed test data files created successfully!');
console.log('ð Generated: /test-data/investortestdata.csv (10 records)');
console.log('ð Generated: /test-data/issuertestdata.csv (12 records)');
console.log('\nð§ Fixes applied:');
console.log('   - Fixed all date formats from ISO (YYYY-MM-DDTHH:mm:ssZ) to YYYY-MM-DD');
console.log('   - Generated proper UUIDs for investor user_id fields');
console.log('   - Fixed JSON formatting issues in issuer address and legal_representatives fields');
console.log('   - Removed problematic double-quote escaping');
console.log('\nâ¨ Test data is now ready for validation!');