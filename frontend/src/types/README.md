# Types Directory

This directory contains TypeScript type definitions that form the foundation of the application's data model. These types ensure type safety and provide a clear structure for the data flowing through the application.

## Type System Architecture

Our type system follows a hierarchical structure with dependencies flowing in one direction:

```
supabase.ts → database.ts → centralModels.ts → component-specific types
```

When supabase.ts is updated (usually through generation from the Supabase schema), the changes flow through this hierarchy.

## Key Files

### supabase.ts
Contains generated types from the Supabase schema. This file provides TypeScript interfaces for database tables, views, functions, and enums defined in the Supabase project. This is the source of truth for database structure.

### database.ts
Extends and re-exports types from `supabase.ts`, providing a centralized place for database-related types. Contains:
- Helper types: `Tables<T>`, `InsertTables<T>`, `UpdateTables<T>`
- Direct table mappings: `PolicyTemplateTable`, `UserTable`, etc.
- Custom interfaces for tables not yet in Supabase schema

### centralModels.ts
The core business models used throughout the application, providing a consistent set of interfaces that represent entities like:
- `BaseModel` - Foundation for all models with common fields
- `User` - User account data and permissions
- `Project` - Investment project information
- `Investor` - Investor profiles and verification status
- `Subscription` - Investment subscriptions
- `RedemptionRequest` - Token redemption requests
- `TokenAllocation` - Token allocation to investors
- Various enums like `UserRole`, `ProjectStatus`, `WalletType`, `TokenType`

### rules.ts
Type definitions for rule-based systems within the application, including:
- Rule interfaces
- Rule condition models
- Rule action types
- Rule evaluation contexts

### permissions.ts
Permission system types including:
- Permission structures
- Role-based access control types
- Permission checking functions

### user.ts
Extended user-related type definitions including:
- User authentication models
- User preference types
- User session information

### users.ts
Additional user types focused on user management features:
- User status types
- User role definitions
- User view models

### policyTemplates.ts
Type definitions specific to policy templates, including:
- Template structures that extend database types
- Template validation rules
- Template rendering models

### types.d.ts
Global type declarations and module augmentations.

### models.ts
Legacy model definitions that are being gradually migrated to centralModels.ts.

## Managing Supabase Type Updates

When `supabase.ts` is updated (such as after a database schema change):

1. Review changes to the generated types
2. Update `database.ts` to handle any new or changed tables:
   - Add new table types using `Tables<'new_table'>`
   - Add new insert/update types using `InsertTables<'new_table'>` and `UpdateTables<'new_table'>`
   - Remove custom interfaces that are now generated by Supabase
3. Update domain-specific type files that extend database types
4. Run type-checking to ensure compatibility

## Usage Patterns

1. **Database Types**: Use types from `database.ts` when working directly with the database
2. **Application Models**: Use types from `centralModels.ts` for business logic and component props
3. **Type Mapping**: Convert between database types and application models using utility functions

## Best Practices

1. Always import database types from `@/types/database.ts`
2. Always import Supabase types from `@/types/supabase.ts`
3. Business models should come from `centralModels.ts`
4. Use `import type { ... } from ...` for type imports
5. Keep type definitions focused on structure, not behavior
6. Update type definitions when creating database migration scripts